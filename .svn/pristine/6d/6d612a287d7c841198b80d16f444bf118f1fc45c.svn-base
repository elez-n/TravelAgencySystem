package db;

import java.sql.Connection;
import java.sql.DriverManager;
import java.util.Properties;


public class MSSQLjdbcConnection extends dbConnection {

    @Override
    public Connection GetConnection(String address, String port, String dbName, String user, String password) {
        
        this.address = address.trim();
        this.dbName = dbName.trim();
        this.port = port.trim();
        
        if (this.port != null && !this.port.isEmpty()) {
            this.fullAddress = this.address + ":" + this.port; 
        } else {
            this.fullAddress = this.address;
        }
        
        this.url = "jdbc:sqlserver://" + this.fullAddress + ";";
        
        if (!isConnectionOpen()) {
            this.user = user.trim();
            this.password = password.trim();
            
            try {
                Properties properties = new Properties();
                properties.put("databaseName", this.dbName);
                properties.put("user", this.user);
                properties.put("password", this.password);
                properties.put("encrypt", "true");
                properties.put("trustServerCertificate", "true");
                properties.put("integratedSecurity", "false");
                
                conn = DriverManager.getConnection(url, properties);
                return conn;
            }
            catch (Exception e) {
                ErrorHandlerMethod(null, e.getMessage());                
            }
            return null;
        }
        return conn;
    }
}